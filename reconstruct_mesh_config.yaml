# Mesh reconstruction config

paths:
  input: /home/sukin707/VesselGPT/Preprocessing_modular/DemoOutput1/TreesSplines
  output_dir: /home/sukin707/VesselGPT/MeshOutput1

params:
  k: 39
  mode: post_order
  pattern: "*.npy"
  max_files: null

  # Reconstruction mode: legacy (notebook), stable (robust radii),
  # sdf_offset (centerline shifted to contour centroids), or loft (VTK surface)
  recon_mode: stable
  # For recon_mode=legacy: choose the implementation
  #   original -> matches notebook / polyfit radius
  #   robust   -> angle-binned radius, safer but not identical
  legacy_variant: original
  radius_mode: percentile    # median | percentile | mean | max
  radius_percentile: 90
  radius_cap: null           # e.g. 0.25 to clamp oversized bulges
  center_mode: centroid      # node | centroid
  fallback_radius: 0.0
  spline_samples: 50         # samples per spline for centroid/loft

  # Output format: ".stl" | ".vtp" | ".ply" (VTK writers)
  output_ext: ".stl"
  overwrite: true

  # Centerline spline used to build the SDF vessel
  centerline_samples: 400
  centerline_smooth: 0.0

  # SDF sampling (coarse -> fine)
  samples_coarse: 32    # 2**5
  samples_fine: 524288  # 2**19
  sparse: false
  use_bounds: true

  # Loft settings (VTK only)
  loft_caps: false
  loft_align: true
  loft_allow_flip: true
  loft_clean: true
  loft_min_radius: 0.0

  # Optional: save resampled centerlines (per branch, columns = x,y,z,branch_id)
  save_centerline: False
  centerline_output_dir: /home/sukin707/VesselGPT/MeshOutput1/centerlines
  centerline_suffix: "_centerline.stl"
  centerline_format: stl
  centerline_tube_radius: 0.001
  centerline_tube_sides: 8
  # branches (root->leaf) or edges (unique parent-child edges)
  centerline_mode: edges
  centerline_edge_samples: 2

  # Optional preview (requires pyvista)
  preview: false
  preview_max: 1
  preview_offscreen: true
  preview_image_dir: /home/sukin707/VesselGPT/MeshOutput1/previews
  preview_color: "red"
